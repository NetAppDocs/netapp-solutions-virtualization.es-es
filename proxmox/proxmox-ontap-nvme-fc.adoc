---
sidebar: sidebar 
permalink: proxmox/proxmox-ontap-nvme-fc.html 
keywords: netapp, proxmox, proxmox ve, nvme, nvme-fc, lvm, ontap, storage 
summary: 'Configurar el Administrador de volúmenes lógicos (LVM) con NVMe sobre canal de fibra para el entorno virtual Proxmox usando ONTAP. Este procedimiento incluye la instalación de nvme-cli, el aprovisionamiento de espacios de nombres, la configuración del subsistema y la creación de grupos de volúmenes para almacenamiento compartido.' 
---
= Configurar LVM con NVMe/FC para Proxmox VE
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Configure el Administrador de volúmenes lógicos (LVM) para el almacenamiento compartido entre hosts del entorno virtual (VE) Proxmox mediante el protocolo NVMe sobre canal de fibra con NetApp ONTAP. Esta configuración proporciona acceso al almacenamiento a nivel de bloque de alto rendimiento con baja latencia utilizando el protocolo NVMe moderno.



== Tareas iniciales del administrador de virtualización

Complete estas tareas iniciales para preparar los hosts Proxmox VE para la conectividad NVMe/FC y recopilar la información necesaria para el administrador de almacenamiento.

. Verifique que haya dos interfaces HBA disponibles.
. En cada host Proxmox del clúster, ejecute los siguientes comandos para recopilar la información de WWPN y verificar que el paquete nvme-cli esté instalado.
+
[source, shell]
----
apt update
apt install nvme-cli
cat /sys/class/fc_host/host*/port_name
nvme show-hostnqn
----
. Proporcione la información NQN y WWPN del host recopilada al administrador de almacenamiento y solicite un espacio de nombres NVMe del tamaño requerido.




== Tareas del administrador de almacenamiento

Si es nuevo en ONTAP, utilice el Administrador del sistema para obtener una mejor experiencia.

. Asegúrese de que la SVM esté disponible con el protocolo NVMe habilitado. Referirse a link:https://docs.netapp.com/us-en/ontap/san-admin/create-nvme-namespace-subsystem-task.html["Documentación de tareas de NVMe en ONTAP 9"].
. Crea el espacio de nombres NVMe.
+
.Mostrar ejemplo
[%collapsible]
====
image:proxmox-ontap-nvme-fc-001.png["creación de espacios de nombres nvme"]

====
. Cree el subsistema y asigne los NQN del host (si usa CLI). Siga el enlace de referencia arriba.
. Asegúrese de que la protección Anti-Ransomware esté habilitada en la pestaña de seguridad.
+
.Mostrar ejemplo
[%collapsible]
====
image:proxmox-ontap-nvme-fc-002.png["Estado anti-ransomware"]

====
. Notifique al administrador de virtualización que se creó el espacio de nombres NVMe.




== Tareas finales del administrador de virtualización

Complete estas tareas para configurar el espacio de nombres NVMe como almacenamiento LVM compartido en Proxmox VE.

. Navegue a un shell en cada host Proxmox VE en el clúster y verifique que el nuevo espacio de nombres esté visible.
. Verifique los detalles del espacio de nombres.
+
[source, shell]
----
nvme list
----
. Inspeccionar y recopilar detalles del dispositivo.
+
[source, shell]
----
nvme list
nvme netapp ontapdevices
nvme list-subsys
lsblk -N
----
. Crear el grupo de volúmenes.
+
[source, shell]
----
vgcreate <volume group name> /dev/mapper/<device id>
# Where <volume group name> is the desired name for the volume group and <device id> is the nvme device id.
pvs
# Verify the physical volume is part of the volume group.
vgs
# Verify the volume group is created.
----
. Uso de la interfaz de administración en `https:<proxmox node>:8006`, haga clic en Centro de datos, seleccione Almacenamiento, haga clic en Agregar y seleccione LVM.
+
.Mostrar ejemplo
[%collapsible]
====
image:proxmox-ontap-nvme-fc-003.png["Navegación de almacenamiento de LVM"]

====
. Proporcione el nombre del ID de almacenamiento, elija el grupo de volúmenes existente y seleccione el grupo de volúmenes que se acaba de crear con la CLI. Marque la opción compartida. Con Proxmox VE 9 y superior, habilite la `Allow Snapshots as Volume-Chain` opción, que es visible cuando la casilla de verificación Avanzado está habilitada.
+
.Mostrar ejemplo
[%collapsible]
====
image:proxmox-ontap-nvme-fc-004.png["lvm en vg existente"]

====
. A continuación se muestra un archivo de configuración de almacenamiento de muestra para LVM usando NVMe/FC:
+
.Mostrar ejemplo
[%collapsible]
====
image:proxmox-ontap-nvme-fc-005.png["Configuración de lvm en nvme fc"]

====


---
sidebar: sidebar 
permalink: migration/shift-toolkit-migration.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary: Utilice Shift Toolkit para migrar máquinas virtuales entre plataformas de virtualización.  El proceso incluye la preparación de las máquinas virtuales, la conversión de formatos de disco y la configuración de los ajustes de red en el entorno de destino. 
---
= Migrar máquinas virtuales mediante el kit de herramientas Shift
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Utilice Shift Toolkit para migrar máquinas virtuales entre plataformas de virtualización.  El proceso incluye la preparación de las máquinas virtuales, la conversión de formatos de disco y la configuración de los ajustes de red en el entorno de destino.



== Migraciones admitidas

El Shift Toolkit proporciona flexibilidad en entornos multihipervisor al admitir la migración bidireccional entre los siguientes hipervisores:

* link:shift-toolkit-migrate-esxi2hyperv.html["VMware ESXi a Microsoft Hyper-V"]
* link:shift-toolkit-migrate-hyperv2esxi.html["Microsoft Hyper-V a VMware ESXi"]
* link:shift-toolkit-migrate-esxi2olvm.html["VMware ESXi a Oracle Linux Virtualization Manager (OLVM)"]
* link:shift-toolkit-migrate-esxi2osv.html["Virtualización de VMware ESXi a Red Hat OpenShift"]
* link:shift-toolkit-migrate-esxi2osv.html["Virtualización de VMware ESXi a Red Hat OpenShift"]




== Flujo de trabajo de migración

Tras crear un plan maestro, puede iniciar el proceso de migración.  Durante la migración, Shift Toolkit realiza una serie de pasos para convertir los formatos de disco y crear máquinas virtuales en el host de destino según lo definido en el plan.

El Shift Toolkit realiza los siguientes pasos durante la migración:

. Eliminar instantáneas existentes para todas las máquinas virtuales en el plano
. Generar instantáneas de máquinas virtuales para el plano en el origen
. Activar instantánea de volumen antes de la conversión del disco
. Clonar y convertir VMDK al formato VHDx para todas las máquinas virtuales
. Encienda las máquinas virtuales del grupo de protección en el destino.
. Registrar las redes en cada máquina virtual
. Elimine VMware Tools y asigne direcciones IP mediante scripts de activación o tareas cron, según el tipo de sistema operativo.




== Prerrequisitos

Las máquinas virtuales deben apagarse correctamente durante la ventana de mantenimiento planificada.  Antes de iniciar la migración, verifique que se cumplen todos los requisitos previos:

* Asegúrese de que la máquina virtual de Shift Toolkit forme parte del dominio
* Asegúrese de que el recurso compartido CIFS esté configurado con los permisos adecuados
* Verifique que el qtree utilizado para la migración o conversión tenga el estilo de seguridad correcto.
* Pruebe la creación de máquinas virtuales mediante el Administrador de Hyper-V desde cualquier host Hyper-V del clúster y coloque el VHDx en el recurso compartido CIFS.
* Pruebe la creación de máquinas virtuales a partir de la máquina virtual de Shift Toolkit agregando herramientas de administración de Hyper-V mediante Programas y características o PowerShell: `add-windowsfeature rsat-hyper-v-tools`



NOTE: Si hay fallos,link:https://learn.microsoft.com/en-us/windows-server/virtualization/hyper-v/manage/remotely-manage-hyper-v-hosts["Habilitar la delegación utilizando cualquier protocolo de autenticación"] .



== Consejos y consideraciones sobre redes

Tenga en cuenta los siguientes requisitos y comportamientos de red al planificar su migración.  La herramienta Shift Toolkit copia automáticamente la configuración de red de las máquinas virtuales de origen y la vuelve a aplicar a las máquinas virtuales migradas, pero la nomenclatura de las interfaces y las configuraciones de los adaptadores de red pueden variar entre los sistemas Windows y Linux.

.Requisito general
* Asegúrese de que haya direcciones IP estáticas disponibles y que no estén asignadas a otra máquina virtual.


.Máquinas virtuales de Windows
* El script de preparación copia los detalles de configuración de red (espacio de direcciones IP, dirección de puerta de enlace, servidores DNS).
* El script de activación vuelve a aplicar la configuración de red durante la migración para una o varias NIC según la asignación de planos.
* Tras la migración, el Administrador de dispositivos de Windows puede mostrar información antigua del adaptador de red anterior a la migración, lo cual no afecta al nuevo adaptador ni provoca conflictos de IP.
* Actualiza a la versión 4.0 para eliminar automáticamente los dispositivos de red huérfanos del registro y del Administrador de dispositivos.


.Máquinas virtuales Linux
* El script de preparación copia los detalles de configuración de la red (espacio de direcciones IP, rutas, servidores DNS, nombres de dispositivos de red).
* El script identifica el tipo de red de la distribución de Linux y aplica la configuración IP correspondiente.
* El script de reasignación de red está configurado como una tarea cron mediante crontab y se ejecuta al arrancar el sistema.
* El script vuelve a aplicar la configuración de red para una o varias NIC según la asignación de planos.


.Nomenclatura de interfaces
* Las máquinas virtuales convertidas pueden tener nombres de interfaz como `eth0` o `ensp0` en lugar de los nombres de las interfaces de origen (por ejemplo, `ens192` o `ens33` )
* El script actualiza los detalles de configuración de red para que coincidan con los nuevos nombres de interfaz.
* Si se utilizan nombres predecibles con las reglas de coincidencia udev adecuadas y el nombre de la interfaz se conserva en el hipervisor de destino, el script omite la configuración de red, elimina VMware Tools y reinicia la máquina virtual.



NOTE: El Shift Toolkit permite anular la preparación de la red, lo que permite a los administradores ejecutar scripts personalizados para la asignación de IP u otras configuraciones.

.Mecanismos de red compatibles
* Administrador de red
* Netplan
* ifconfig
* malvado


El Shift Toolkit conserva las direcciones IP tal como se especifican en el plano.



== Fases de migración

Las siguientes son las fases de migración que seguirá para migrar máquinas virtuales utilizando Shift Toolkit.

. *Preparar la máquina virtual*: Prepare las máquinas virtuales para la migración y verifique que se hayan completado todos los requisitos previos.
. *Migrar y validar*: Una vez completada la preparación, migre las máquinas virtuales de VMware al hipervisor de destino.
+
Una vez finalizada la migración, verifique que las máquinas virtuales arranquen correctamente y que los datos se hayan migrado correctamente.

. *Probar la migración*: La prueba de migración simula la migración convirtiendo el VMDK al formato apropiado y creando máquinas virtuales utilizando el archivo de disco virtual convertido en el qtree.
+
La migración de prueba no incluye la configuración de mapeo de red, que debe realizarse manualmente en una red de prueba.




NOTE: El Shift Toolkit no modifica la máquina virtual de origen, excepto para copiar los scripts necesarios para su preparación.  Esto permite una rápida reversión en caso de fallos en la conversión.



== Ejecutar una migración

Para iniciar el flujo de trabajo de migración con la configuración especificada en el plano, haga clic en *Migrar*.

image::shift-toolkit-030.png[Diálogo que muestra cómo iniciar una migración de máquina virtual]

Una vez iniciado, el flujo de trabajo se activa y el proceso de conversión sigue los pasos descritos para registrar la máquina virtual.  Si las máquinas virtuales dentro del plano no están apagadas, Shift Toolkit solicita un apagado correcto antes de continuar.

image::shift-toolkit-031.png[Confirmación del proceso de migración]


NOTE: NetApp recomienda no activar más de diez conversiones en paralelo desde la misma fuente al mismo destino.

image::shift-toolkit-032.png[Progreso migratorio]

La conversión de VMDK a cualquier formato de archivo se completa en segundos, lo que la convierte en la opción más rápida disponible.  Este enfoque ayuda a reducir el tiempo de inactividad de las máquinas virtuales durante la migración.

image::shift-toolkit-033.png[Progreso de la conversión del disco]

Una vez finalizado el trabajo, el estado del plano cambia a "Migración completa".

image::shift-toolkit-034.png[Estado de migración completado]
